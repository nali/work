<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Work by nali</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <section>
        <h1>
<a id="a-sample-of-the-work-of-nabeelah-ali" class="anchor" href="#a-sample-of-the-work-of-nabeelah-ali" aria-hidden="true"><span class="octicon octicon-link"></span></a>A sample of the work of Nabeelah Ali</h1>

<h2>
<a id="confluence-feature-development" class="anchor" href="#confluence-feature-development" aria-hidden="true"><span class="octicon octicon-link"></span></a>Confluence Feature development</h2>

<p>I currently work at Atlassian, where I work on one of Atlassian's flagship products: <a href="https://www.atlassian.com/software/confluence">Confluence</a> - a collaborative wiki designed to replace email. Here are a couple of projects I've worked on over the years.</p>

<h3>
<a id="multi-file-type-previewer" class="anchor" href="#multi-file-type-previewer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multi file type previewer</h3>

<p>Languages: <code>JavaScript</code>, <code>HTML</code>, <code>CSS</code></p>

<p>Libraries &amp; tools: <code>Backbone.js</code>, <code>underscore.js</code>, <code>jQuery</code>, <code>Karma</code>, <code>QUnit</code>, <code>sinon.js</code>, <code>almond</code>, <code>WebDriver</code></p>

<p>Involvement: Developer in a team of 2</p>

<p>At Atlassian, we used to use fancybox in almost all our applications. We wanted to replace fancybox with our own file viewer that was lightweight, supported our own set of features, like annotating files,
and more than just images. Along with a graduate developer, I wrote a component that now has almost 200,000 users daily (and no major issues have arisen!). I'm proud of creating a quality, cross-browser file viewer, and mentoring the graduate developer through the process. The API has been easy enough to use that another Atlassian team has started using the file viewer in their product. </p>

<p>Screenshot: 
<img src="https://raw.githubusercontent.com/nali/work/master/screenshots/file_viewer.png" alt=""></p>

<p>HTML extract   </p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;div id="cp-container"&gt;
        &lt;div class="aui-group" id="cp-header"&gt;
            &lt;div class="aui-item expanded" id="cp-title-container"&gt;
                &lt;div data-type="image"&gt;
                    IMG_9857.JPG
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="aui-item" id="cp-file-controls"&gt;
                &lt;span&gt;&lt;a class="cp-icon" href="#" id="cp-control-panel-upload"
                style=
                "position: relative; z-index: 0;"&gt;&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&lt;a class=
                "cp-icon" href=
                "https://extranet.atlassian.com/download/attachments/2302285232/IMG_9857.JPG?version=1&amp;amp;modificationDate=1411349441938&amp;amp;api=v2"
                id="cp-control-panel-download"&gt;&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&lt;a class=
                "cp-icon" href="#" id="cp-control-panel-close"&gt;&lt;/a&gt;&lt;/span&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="minimode-banner short" id="cp-file-body"&gt;
            &lt;div class="cp-file-body-content"&gt;
                &lt;div id="cp-image-preview"&gt;
                    &lt;div class="cp-image-container cp-fit-height"&gt;&lt;img alt=
                    "IMG_9857.JPG" class="panning" id="cp-img" src=
                    "https://extranet.atlassian.com/download/attachments/2302285232/IMG_9857.JPG?version=1&amp;amp;modificationDate=1411349441938&amp;amp;api=v2"
                    style="width: auto; height: 100%;"&gt;&lt;/div&gt;&lt;span class=
                    "cp-baseline-extension"&gt;&lt;/span&gt;

                    &lt;div id="cp-file-control" style="display: none;"&gt;
                        &lt;a class="cp-icon" href="#" id=
                        "cp-file-control-minus"&gt;Zoom out&lt;/a&gt;&lt;a class="cp-icon"
                        href="#" id="cp-file-control-plus"&gt;Zoom in&lt;/a&gt;&lt;a class=
                        "cp-icon" href="#" id="cp-file-control-fit"&gt;Fit to page
                        width&lt;/a&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div&gt;
                &lt;div class="cp-spinner"&gt;&lt;/div&gt;
            &lt;/div&gt;

            &lt;div&gt;
                &lt;a class="cp-nav" href="#" id="cp-nav-left" style=
                "display: inline;"&gt;Go to the previous file&lt;/a&gt;&lt;a class="cp-nav"
                href="#" id="cp-nav-right" style="display: inline;"&gt;Go to the
                next file&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="panel-view expanded" id="cp-footer"&gt;
            &lt;div id="cp-footer-bar"&gt;
                &lt;a href="#" id="cp-files-label"&gt;Show all files&lt;span class=
                "aui-icon aui-icon-small aui-iconfont-arrows-up cp-files-collapser up"&gt;Show
                all files&lt;/span&gt;&lt;span class=
                "aui-icon aui-icon-small aui-iconfont-arrows-down cp-files-collapser down hidden"&gt;Hide
                all files&lt;/span&gt;&lt;/a&gt;
            &lt;/div&gt;

            &lt;div id="cp-footer-minimode"&gt;
                &lt;ol id="cp-thumbnails"&gt;
                    &lt;li class="cp-thumbnail"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of image2014-9-22 11:21:27.png"
                                src=
                                "https://extranet.atlassian.com/download/thumbnails/2302285232/image2014-9-22%2011%3A21%3A27.png?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                image2014-9-22 11:21:27.png
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;

                    &lt;li class="cp-thumbnail"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of naplassian-3.gif"
                                src="https://extranet.atlassian.com/download/thumbnails/2302285232/naplassian-3.gif?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                naplassian-3.gif
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;

                    &lt;li class="cp-thumbnail"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of IMG_9849-001.JPG"
                                src="https://extranet.atlassian.com/download/thumbnails/2302285232/IMG_9849-001.JPG?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                IMG_9849-001.JPG
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;

                    &lt;li class="cp-thumbnail"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of IMG_9830.JPG" src=
                                "https://extranet.atlassian.com/download/thumbnails/2302285232/IMG_9830.JPG?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                IMG_9830.JPG
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;

                    &lt;li class="cp-thumbnail"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of IMG_9825.JPG" src=
                                "https://extranet.atlassian.com/download/thumbnails/2302285232/IMG_9825.JPG?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                IMG_9825.JPG
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;

                    &lt;li class="cp-thumbnail"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of image2014-9-22 17:7:34.png"
                                src=
                                "https://extranet.atlassian.com/download/thumbnails/2302285232/image2014-9-22%2017%3A7%3A34.png?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                image2014-9-22 17:7:34.png
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;

                    &lt;li class="cp-thumbnail selected"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of IMG_9857.JPG" src=
                                "https://extranet.atlassian.com/download/thumbnails/2302285232/IMG_9857.JPG?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                IMG_9857.JPG
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;

                    &lt;li class="cp-thumbnail"&gt;
                        &lt;figure class="cp-thumbnail-group"&gt;
                            &lt;div class="cp-thumbnail-img"&gt;
                                &lt;a class="cp-thumbnail-img-container" href=
                                "#"&gt;&lt;img alt=
                                "View a larger version of image2014-9-22 10:17:40.png"
                                src=
                                "https://extranet.atlassian.com/download/thumbnails/2302285232/image2014-9-22%2010%3A17%3A40.png?api=v2"&gt;&lt;/a&gt;
                            &lt;/div&gt;

                            &lt;figcaption class="cp-thumbnail-title"&gt;
                                image2014-9-22 10:17:40.png
                            &lt;/figcaption&gt;
                        &lt;/figure&gt;
                    &lt;/li&gt;
                &lt;/ol&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="panel-view" id="cp-sidebar"&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Code extract: </p>

<pre><code>define("cp/component/minimode/file-minimode-view",
    [
        "jquery",
        "ajs",
        "backbone",
        "cp/component/minimode/file-thumbnail-view",
        "cp/component/template-store-singleton"
    ],
    function(
        $,
        AJS,
        Backbone,
        FileThumbnailView,
        templateStore
    ) {
        "use strict";

        var FileMinimodeView = Backbone.View.extend({

            id: "cp-footer-minimode",

            initialize: function(options) {
                this.subviews = [];
                this._fileViewer = options.fileViewer;
                this._panelView = options.panelView;
                this.listenTo(this.collection, 'add reset', this.render);
                this.listenTo(this._panelView, 'togglePanel', this._fireAnalytics);
                this.listenTo(this._panelView, 'renderPanel', this._forceChromeRepaint);
                this.listenTo(this._panelView, 'renderPanel', this.scrollToSelected);
                this.$minimode = $(templateStore.get('minimode')());
                this.$minimode.appendTo(this.$el);
            },

            closeOldSubviews: function() {
                while (this.subviews.length &gt; 0) {
                    var view = this.subviews.pop();
                    view.remove();
                    view.unbind();
                }
            },

            render: function() {
                this.closeOldSubviews();

                this.collection.each(function(model) {
                    var view = new FileThumbnailView({
                        model: model,
                        fileViewer: this._fileViewer,
                        panelView: this._panelView
                    });
                    this.subviews.push(view);
                    $(view.render().el).appendTo(this.$minimode);
                }, this);

                return this;
            },

            scrollToSelected: function() {
                var file = this._fileViewer._fileState.getCurrent();
                this.subviews.forEach(function (view) {
                    if(view.model === file) {
                        var topPos = view.$el.get(0).offsetTop - 59;
                        if ((topPos) &amp;&amp; this.$el.scrollTop !== topPos) {
                            this.$el.find("#cp-thumbnails").scrollTop(topPos);
                        }
                    }
                }.bind(this));
            },

            _fireAnalytics: function(panelId, isExpanded) {
                if (panelId === 'minimode') {
                    AJS.trigger('analyticsEvent',
                        {name: isExpanded ?
                            'confluence-spaces.previews.minimode.opened' :
                            'confluence-spaces.previews.minimode.closed'
                        }
                    );
                }
            },

            _forceChromeRepaint: function() {
                // Chrome doesn't respect the 100% height on images once the container is resized.
                var $img = $("#cp-img");
                if ($img.length) {
                    var $preview = $img.closest("#cp-image-preview"),
                        left = $preview.scrollLeft(),
                        top = $preview.scrollTop();
                    $img.css('display', 'none').height();
                    $img.css('display', 'inline-block');
                    $preview.scrollLeft(left);
                    $preview.scrollTop(top);
                }
            }

        });

        return FileMinimodeView;
    }
);  
</code></pre>

<h3>
<a id="aggregated-notifications-inbox" class="anchor" href="#aggregated-notifications-inbox" aria-hidden="true"><span class="octicon octicon-link"></span></a>Aggregated notifications inbox</h3>

<p>Libraries &amp; tools: <code>Backbone.js</code>, <code>underscore.js</code>, <code>jQuery</code>, <code>Jasmine</code></p>

<p>Involvement: developer in a team of two backend devs and one other frontend dev</p>

<p>Email is a problem. The aggregated notifications inbox was designed as the place for all your notifications, across Atlassian products. It features polling to get the latest updates, and allows notifications to be starred, and notes added, for later reference.</p>

<p><img src="http://atlassian.wpengine.netdna-cdn.com/wp-content/uploads/team-collaboration-software-confluence-notifications1.png" alt="Confluence tasks"></p>

<h3>
<a id="user-onboarding-experiments" class="anchor" href="#user-onboarding-experiments" aria-hidden="true"><span class="octicon octicon-link"></span></a>User onboarding experiments</h3>

<p>Languages: <code>JavaScript</code>, <code>HTML</code>, <code>CSS</code></p>

<p>Libraries &amp; tools: <code>underscore.js</code>, <code>jQuery</code>, <code>grunt</code>, <code>RequireJS</code></p>

<p>Involvement: sole developer</p>

<p>How do you help users get up to speed with software? This has been the question I've been thinking about for the past couple of months. With Confluence, we want user engagement up in the first couple of days (this often results in an increase in conversion rates to paying customers). I've been writing fast, prototype-style experiences and running them as experiments on new evaluators of Confluence to determine whether they increase engagment.</p>

<p>Here's an example of one of those experiences that I wrote:</p>

<p>Screenshot:
<img src="https://raw.githubusercontent.com/nali/work/master/screenshots/grow1421.gif" alt="Experiment"></p>

<h2>
<a id="lenditt---a-collaborative-consumption-experiment" class="anchor" href="#lenditt---a-collaborative-consumption-experiment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lenditt - a collaborative consumption experiment</h2>

<p>Languages: <code>JavaScript</code>, <code>HTML</code>, <code>CSS</code>, <code>Python</code> (Django)</p>

<p>Libraries &amp; tools: <code>Backbone.js</code>, <code>underscore.js</code>, <code>jQuery</code>, <code>bootstrap</code></p>

<p>Involvement: Sole developer + design</p>

<p>While doing my Masters degree in Computer Science and living in a small community, I created a site that would allow people to rent out commonly-used items to each other. The website was a social experiment. I acted as designer as well as full stack developer. </p>

<p>Screenshot:
<img src="https://raw.githubusercontent.com/nali/work/master/screenshots/lenditt.png" alt="Lenditt"></p>

<h2>
<a id="typespeed---a-kitsch-star-wars-themed-typing-game" class="anchor" href="#typespeed---a-kitsch-star-wars-themed-typing-game" aria-hidden="true"><span class="octicon octicon-link"></span></a>Typespeed - a kitsch Star Wars themed typing game</h2>

<p>Languages: <code>Clojure</code></p>

<p>Libraries &amp; tools: <code>Leiningen</code></p>

<p>Involvement: pair programmed</p>

<p>With <a href="http://hjonasson.github.io/">my husband</a>, I wrote a typing game in Clojure for fun. It was an interesting challenge to try an develop in a functional style. The graphics are intended to be retro-kitsch. </p>

<p>Screenshot:
<img src="https://raw.githubusercontent.com/nali/work/master/screenshots/typewars_still.png" alt="Typewars"></p>

<p><a href="https://raw.githubusercontent.com/nali/work/master/screenshots/typewars.gif">See an animated gif of the game in action</a>.</p>

<p>Code extract: 
  (ns typewars.core
      (:gen-class :main true)
      (:require 
        [clojure.contrib.string :as st]
        [clojure.java.io :as io])
      (:use quil.core)
    )</p>

<pre><code>(import '(java.applet Applet)
        '(java.io File)
        '(java.net URL))

(defn rand-seek [x]
  (nth x (rand-int (count x)))
)

(defn get-lines [wordfile]
  "Seek each word to be typed, from a file"
  (with-open [r (io/reader wordfile)]
    (doall (line-seq r))))

(defn clean-word [s]
  "Given a string, lower-case words with whitespace and punctuation removed"
  (map #(.toLowerCase %) (filter #(not (.isEmpty %)) (seq (.split #"[\s\W]+" s)))))

(defn play-url [url-string]
  (.play (Applet/newAudioClip (URL. url-string))))

(defn find-sound [file-name]
  "Tailors soundclip addresses for play-url"
  (let [absolute-name (.getAbsolutePath (File. file-name))]
        (str "file://" absolute-name)
  )
)

(defn get-star-wars-quote []
  (let [quotes (list "May the Force be with you" 
                     "I find your lack of faith disturbing"
                     "Iâ€™ve got a very bad feeling about this"
                     "Youâ€™re all clear, kid! Now letâ€™s blow this thing and go home!"
                     "The Force is strong with this one"
                     "What a piece of junk!"
                     "Watch your mouth kid, or youâ€™ll find yourself floating home"
                     "Arenâ€™t you a little short for a stormtrooper?"
                     "You came in here and you didnâ€™t have a plan for getting out?"
                     "Into the garbage chute, flyboy!"
                     "I suggest a new strategy, R2. Let the wookiee win"
                     "When I left you, I was but the learner, now I am the master"
                     "These arenâ€™t the droids youâ€™re looking for"
                     "I've always liked your shoes")]
    (rand-seek quotes)
  )
)

(defn setup []
  (let [funfont (create-font "resources/ProFontWindows.ttf" 30)
        wordfile "resources/intro.txt"                          ; The file containing a newline separated word list
        bgfile   "resources/mainscreen.jpg"       ; The background image
        introfile "resources/introscreen.jpg"         ; The intro image
        endfile  "resources/endscreen.jpg"  ; The image to be displayed at the end 
        forcebarfile "resources/lightsbr.png"]
    (frame-rate 24)
    (smooth)
    (background 0)
    (text-font funfont)
    (no-fill)
    (set-state! :score        (atom 0)
                :typed        (atom "")
                :game         (atom '())
                :words        (atom (get-lines wordfile))
                :missedwords  (atom 0)
                :ended        (atom -1)
                :bg           (load-image bgfile)
                :intro        (load-image introfile)
                :end          (load-image endfile)
                :forcebar     (load-image forcebarfile)
                :quotesw      (atom (get-star-wars-quote))
                :wordfile     wordfile
    )
  )
)

(defn make-str
  "Make a string from a sequence of characters"
  ([chars] (make-str chars ""))
  ([chars result]
    (if (zero? (count chars))
      result
      (recur (drop 1 chars) (str result (first chars)))
    )
  )
)

(defn is-in [n typed word]
  (if (&gt; n 0)
    (if (= (take n word) (take-last n typed))
      n
      (is-in (- n 1) typed word)    
    )
    0
  )
)

(defn drawword [x]
  (let [typed (state :typed)
        n     (is-in (count (x :word)) @typed (x :word))]
    (fill 255 255 255)
    (text (make-str (take n (x :word))) (x :posx)  (x :posy))
    (fill 206 145 60)
    (text (make-str (take-last (- (count (x :word)) n) (x :word))) (+ (x :posx) (* n 15)) (x :posy))
  )
)

(defn updatepos [y]
  (do (update-in y [:posx] #(+ % (:speed y))))
)

(defn get-ypos [] 
  (+ (rand-int (- (height) 150)) 75)
)

(defn get-speed []
  (+ (rand-int 5) 2)
)

(defn end-game []
  (let [ended   (state :ended)
        quotesw (state :quotesw)]
    (reset! ended 1)
    (reset! quotesw (get-star-wars-quote))
  )
)

(defn get-word []
  (let [words   (state :words)]
    (do
      (reset! words (rest @words)) 
      (first (clean-word (first @words)))

    )
  )
)

(defn newitem []
  (let [posx-list   (take 20 (range))
        word        (get-word)]
    (if (not= word nil)
      {:word word
      :posx (rand-seek posx-list)
      :posy (get-ypos)
      :speed (get-speed)}
      (end-game)
    )
  )
)

(defn reset-game []
  (let [game (state :game)
        typed (state :typed)
        missedwords (state :missedwords)
        words (state :words)
        score (state :score)]
  (reset! game '())
  (reset! missedwords 0)
  (reset! words '())
  (reset! typed "")
  ;(reset! score 0)
  )
)

(defn matchword [x]
  (let [game    (state :game)
        typed   (state :typed)
        score   (state :score)
        sounds  (map find-sound '("resources/lasrhit1.wav" "resources/lasrhit2.wav" "resources/lasrhit3.wav" "resources/lasrhit4.wav"))]
    (if (clojure.contrib.string/substring? (x :word) @typed);if a substring of what is typed is a word
      (do (swap! score + (* (count (x :word)) (x :speed)))         
          (reset! typed "")
          (play-url (rand-seek sounds))
          true)
      false
    )
  )
)

(defn draw []
  (let [game        (state :game)
        score       (state :score)
        words       (state :words)
        numwords    (count @words)
        gamelength  (count @game)
        bg          (state :bg)
        end         (state :end) 
        intro       (state :intro)
        ended       (state :ended)
        forcebar    (state :forcebar)
        missedwords (state :missedwords)
        quotesw     (state :quotesw)
        ]

      (if (= -1 @ended)
        (background-image intro)
        (do 
          (if (and (&lt; gamelength 1) (= 1 @ended))
            (do (background-image end)
                (text-size 40)
                (fill 212 210 56)
                (text-align :center)
                (text @quotesw 630 100)
                (text (str "SCORE " @score) 630 395)
                (text-align :left)
            )

          (if (or (&gt; numwords 0) (&gt; gamelength 0))
            (do (background-image bg)
              (if (= @missedwords 10)
                (do
                  (end-game)
                  (reset-game)
                )
              )
              (let [life (* (/ @missedwords 10) 240) 
                    screencopy (get-pixel (- 400 life) 40 (+ 20 life) 43)]
                (set-image 30 40 forcebar)
                (set-image (- 400 life) 40 screencopy)
              )
              (fill 255 255 255)
              (text (str "SCORE " @score) 30 (- (height) 25))
              (doall (map drawword @game))
              (reset! game (map updatepos @game))
              (swap! missedwords + (count (filter #(&gt; (% :posx) (width)) @game)))
              (reset! game (remove #(&gt; (% :posx) (width)) @game))

              (if (&gt; numwords 1)
                (if (= 0 (mod (frame-count) (+ 20 (rand-int 10))))
                  (reset! game (concat @game (list (newitem))))
                )
              (end-game)
              )
              )
            )
          )
        )
      )
  )
)


(defn key-press []
  (let [typed (state :typed)
        game (state :game)
        letter (str (raw-key))
        ended (state :ended)
        words (state :words)
        wordfile (state :wordfile)
        missedwords (state :missedwords)]
      (if (and (or (= -1 @ended) (= 1 @ended)) (= letter " "))
        (do 
          (reset-game)
          (reset! words (get-lines wordfile))
          (reset! ended 0)
          ;(play-url (find-sound "resources/cantina.mid"))
          (text-size 30)
        )  
      (do  
        (reset! typed (str @typed letter))
        (reset! game (remove matchword @game))
      )
    )
  )
)

(defsketch gen-art-3
  :title "TYPEWARS"
  :setup setup
  :draw draw
  :size [1260 630]
  :key-typed key-press
)
</code></pre>

<h2>
<a id="more" class="anchor" href="#more" aria-hidden="true"><span class="octicon octicon-link"></span></a>More?</h2>

<p>I keep most of my code for personal projects over at <a href="https://bitbucket.org/nali">https://bitbucket.org/nali</a>.</p>
      </section>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>